<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Profile Management System</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #141E30, #243B55);
      color: white;
      margin: 0;
      padding: 0;
    }
    header {
      background: #111;
      padding: 20px;
      text-align: center;
      font-size: 1.8em;
      font-weight: bold;
      color: #00bcd4;
      letter-spacing: 2px;
    }
    main {
      padding: 20px;
      max-width: 1000px;
      margin: auto;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, select {
      padding: 8px;
      border: none;
      border-radius: 5px;
      font-size: 1em;
    }
    button {
      padding: 10px;
      background: #00bcd4;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #008c9e;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: rgba(255, 255, 255, 0.15);
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      color: white;
    }
    th {
      background: #00bcd4;
    }
    .action-btn {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 0.9em;
      border-radius: 5px;
      border: none;
      cursor: pointer;
    }
    .edit {
      background: #ffc107;
      color: #000;
    }
    .delete {
      background: #f44336;
      color: #fff;
    }
    h3 {
      text-align: center;
      margin-top: 40px;
      color: #00e5ff;
    }
    canvas {
      background: white;
      border-radius: 10px;
      padding: 20px;
    }
  </style>
</head>
<body>

  <header>ðŸŽ“ Student Profile Management System</header>

  <main>
    <h2 id="form-title">Add New Student</h2>
    <form id="student-form">
      <input type="text" id="name" placeholder="Full Name" required />
      <input type="text" id="roll" placeholder="Roll Number" required />
      <input type="email" id="email" placeholder="Email Address" required />
      <select id="department" required>
        <option value="">Select Department</option>
        <option value="Computer Application">Computer Application</option>
        <option value="Information Technology">Information Technology</option>
        <option value="Electronics">Electronics</option>
        <option value="Mechanical">Mechanical</option>
      </select>
      <button type="submit" id="submit-btn">Add Student</button>
    </form>

    <table id="student-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Roll No</th>
          <th>Email</th>
          <th>Department</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>ðŸ“Š Admin Dashboard: Department Statistics</h3>
    <canvas id="deptChart"></canvas>
  </main>

  <script>
    // Load existing students
    let students = JSON.parse(localStorage.getItem("students")) || [];
    const form = document.getElementById("student-form");
    const tableBody = document.querySelector("#student-table tbody");
    const submitBtn = document.getElementById("submit-btn");
    const formTitle = document.getElementById("form-title");
    let editIndex = -1;

    const ctx = document.getElementById("deptChart").getContext("2d");
    let deptChart;

    function updateChart() {
      const departments = ["Computer Application", "Information Technology", "Electronics", "Mechanical"];
      const counts = departments.map(dep => students.filter(s => s.department === dep).length);

      if (deptChart) deptChart.destroy();
      deptChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: departments,
          datasets: [{
            label: "Number of Students",
            data: counts,
            backgroundColor: ["#00bcd4", "#4caf50", "#ffc107", "#f44336"],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: { beginAtZero: true, ticks: { color: "black" } },
            x: { ticks: { color: "black" } }
          },
          plugins: { legend: { labels: { color: "black" } } }
        }
      });
    }

    function renderTable() {
      tableBody.innerHTML = "";
      students.forEach((student, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${student.name}</td>
          <td>${student.roll}</td>
          <td>${student.email}</td>
          <td>${student.department}</td>
          <td>
            <button class="action-btn edit" onclick="editStudent(${index})">Edit</button>
            <button class="action-btn delete" onclick="deleteStudent(${index})">Delete</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
      localStorage.setItem("students", JSON.stringify(students));
      updateChart();
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const student = {
        name: document.getElementById("name").value,
        roll: document.getElementById("roll").value,
        email: document.getElementById("email").value,
        department: document.getElementById("department").value,
      };

      if (editIndex === -1) {
        students.push(student);
      } else {
        students[editIndex] = student;
        editIndex = -1;
        submitBtn.textContent = "Add Student";
        formTitle.textContent = "Add New Student";
      }

      form.reset();
      renderTable();
    });

    function editStudent(index) {
      const student = students[index];
      document.getElementById("name").value = student.name;
      document.getElementById("roll").value = student.roll;
      document.getElementById("email").value = student.email;
      document.getElementById("department").value = student.department;
      submitBtn.textContent = "Update Student";
      formTitle.textContent = "Edit Student";
      editIndex = index;
    }

    function deleteStudent(index) {
      if (confirm("Are you sure you want to delete this student?")) {
        students.splice(index, 1);
        renderTable();
      }
    }

    renderTable();
  </script>

</body>
</html>
